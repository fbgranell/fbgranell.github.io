<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Traffic &amp; Air Quality study | Fernando Borrero Granell</title> <meta name="author" content="Fernando Borrero Granell"> <meta name="description" content="Analysis on the relationship between Madrid's traffic flow and its own air quality levels."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <script async src="https://www.googletagmanager.com/gtag/js?id=G-L8BL6VYKDK"></script> <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-L8BL6VYKDK");</script> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.ico"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://fbgranell.github.io/projects/traffic_air_madrid/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Fernando </span>Borrero Granell</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About me</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV</a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Traffic &amp; Air Quality study</h1> <p class="post-description">Analysis on the relationship between Madrid's traffic flow and its own air quality levels.</p> </header> <article> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/p3/header.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Traffic Air Quality study" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div id="table-of-contents"> <p>Table of Contents:</p> <ul> <li><a href="#section1">Introduction.</a></li> <li><a href="#section2">Materials and Methods.</a></li> <li><a href="#section3">Results.</a></li> <li><a href="#section4">References.</a></li> <li><a href="#section5">License.</a></li> </ul> </div> <p><a id="section1"></a></p> <h3 id="introduction">Introduction</h3> <p>In this project we study the relationship between Madrid’s air quality and the amount of traffic flow through the city center. It’s important to have in mind that the atmosphere is an open system, and thus we expect to find no strong correlation between traffic levels and air quality (since the emissions from vehicles can move to any other area, they don’t have to stay in the city). Basically, we are just checking if there’s a local relationship between traffic flow fluctuations and the levels of concentration of some specific particles. You can check the code <a href="https://github.com/fbgranell/analysis-traffic-airquality-madrid" rel="external nofollow noopener" target="_blank">here</a>.</p> <p><a id="section2"></a></p> <h3 id="materials-and-methods">Materials and Methods</h3> <p>The methods of this study include the followings:</p> <ul> <li>Data wrangling</li> <li>MySQL</li> <li>Data cleaning</li> <li>Exploratory data analysis</li> <li>ML: Linear regression</li> <li>Data visualization (Tableau)</li> </ul> <p>The database consists of more than 100 files, and thus a script was required to automate the process for a fast data merge. Because of the nature of our study, we also had to aggregate our data by weeks.</p> <p>The study only focuses on the city center, and thus some stations had to be filtered out, as we can see below.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/p3/airpol_3.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Traffic stations" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/p3/airpol_4.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Air quality stations" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The left (right) map shows the Traffic (Air Quality) stations that were used in blue. </div> <p>We have data for the traffic flow. However, we do not have data on the individual flow \(j_i\) of each category of vehicle (cars, motorbikes, buses, etc). We suppose the individual flow is just dependant on the proportion of circulating vehicles of that category, \(j_i = J \times n_i/n_T\). However, we do not know \(n_i\) (number of circulating vehicles of category i) nor \(n_T\) (total number of vehicles circulating). So we approximate this value: we make the assumption that the proportion of accidents of vehicles i (\(acc_i/acc_T\)) is proportional to the proportion of vehicles i circulating, that is \(n_i/n_T \approx \alpha_i \times acc_i / acc_T\). And so we have: <br></p> <center> $$ j_i = J \times n_i /n_T \approx J \times \alpha_i \times acc_i/acc_T$$ </center> This constant \(\alpha_i\) is different for every category of vehicles, and it relates the real proportion of circulating vehicles of category i with the proportion of accidents of the same category (this constant acts as an indicator of how likely the vehicle \(i\) is to have an accident). We assume this constant does not change with time (the probability of having an accident with each vehicle should not change with time). <p><br>Since we have data for \(n_i/n_T\) for two specific years: 2017 and 2013, we can use both to compute the constant of each category in each year, and then choose our coefficients as the mean of both. We will then use it for the rest of the years.</p> <p>Finally, we model their depedency through a linear regression in order to understand the impact of traffic in the local Air Quality (we see this in the next plot).</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/p3/airpol_5.png" class="img-fluid rounded" width="auto" height="auto" title="Linear regression" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Example: HC Air quality mean measurements against traffic levels (per type fo transport). </div> <p>From this graph we can see how each vehicle flow affects the local air. However, the scales are not the same. Hence, we create a new bar plot to compare the value of the slopes with impartiality.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/p3/airpol_6.png" class="img-fluid rounded" width="auto" height="auto" title="Barplot of slopes" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Example: Barplot of the slope values for each vehicle affecting the HC molecule. </div> <p>These values represent the amount of local emissions an individual vehicle is related to. It’s important to understand this: the slopes represent how pollution would rise if we were to increase the number of vehicles of type \(i\) (it’s not the total pollution from each vehicle type).</p> <p><a id="section3"></a></p> <h3 id="results">Results</h3> <h4 id="carbon-monoxide-co">Carbon monoxide (CO)</h4> <p>Scouters are allowed to emit higher concentrations of CO, and thus we did expect these results.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/p3/airpol_7.png" class="img-fluid rounded" width="auto" height="auto" title="CO" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Barplot: slope values for each vehicle affecting CO. </div> <h4 id="hydrocarbon-hc">Hydrocarbon (HC)</h4> <p>Heavy vehicles such as Buses, Trucks and Vans were the most related to local HC emissions in our data.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/p3/airpol_6.png" class="img-fluid rounded" width="auto" height="auto" title="HC" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Barplot: slope values for each vehicle affecting HC. </div> <h4 id="nitrogen-oxides-nox">Nitrogen oxides (NOx)</h4> <p>According to our data, motorbikes and buses were the most polluting towards local NOx.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/p3/airpol_8.png" class="img-fluid rounded" width="auto" height="auto" title="NOX" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Barplot: slope values for each vehicle affecting NOx. </div> <p><a id="section4"></a></p> <h3 id="references">References</h3> <p>The air quality and traffic flow data was sourced from <a href="https://datos.madrid.es/portal/site/egob" rel="external nofollow noopener" target="_blank">Madrid’s Data Portal</a>. This portal provides open access to a wide range of data and information on the city of Madrid, including environmental and transportation data. All data used in this report was obtained from the Madrid Data Portal and is subject to their terms and conditions of use. <a id="section5"></a></p> <h3 id="license">License</h3> <p>This is an educational project; therefore, all materials can be used freelly.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Fernando Borrero Granell. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>